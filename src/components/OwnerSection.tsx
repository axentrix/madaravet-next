'use client';

import { useEffect, useRef } from 'react';

export default function OwnerSection() {
  const sectionRef = useRef<HTMLDivElement>(null);
  const imageRef = useRef<HTMLImageElement>(null);
  const circleRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    if (typeof window === 'undefined') return;

    // Only animate on desktop
    const isMobile = window.innerWidth < 768;
    if (isMobile) return;

    const loadGSAP = async () => {
      // Prefer global GSAP from CDN if available
      const gsap = (window as any).gsap || (await import('gsap')).default;
      const ScrollTrigger = (window as any).ScrollTrigger || (await import('gsap/ScrollTrigger')).default;
      
      if (!gsap || !ScrollTrigger) {
        console.warn('GSAP or ScrollTrigger not available');
        return;
      }
      
      gsap.registerPlugin(ScrollTrigger);

      const image = imageRef.current;
      const circle = circleRef.current;

      if (!image || !circle) return;

      // Set initial state
      gsap.set(image, { x: -100, opacity: 0 });
      gsap.set(circle, { x: 100, opacity: 0, scale: 0.8 });

      // Create animation timeline
      const tl = gsap.timeline({
        scrollTrigger: {
          trigger: sectionRef.current,
          start: 'top center',
          end: 'center center',
          scrub: 1,
          toggleActions: 'play reverse play reverse'
        }
      });

      tl.to(image, { x: 0, opacity: 1, duration: 1 }, 0)
        .to(circle, { x: 0, opacity: 1, scale: 1, duration: 1 }, 0);
    };

    loadGSAP();
  }, []);

  return (
    <section ref={sectionRef} className="owner-section py-16 md:py-24">
      <div className="owner-container">
        <div className="owner-grid">
          
          {/* Image of Dr. Sokolova */}
          <div className="owner-image-wrapper">
            <img 
              ref={imageRef}
              src="https://api.builder.io/api/v1/image/assets/TEMP/e67f13055d6863b8df402e0552a23874b2b3deae?width=829" 
              alt="Dr. Yuliana Sokolova"
              className="owner-image"
            />
          </div>

          {/* Circular info card */}
          <div 
            ref={circleRef}
            className="owner-circle"
          >
            <svg className="owner-logo" viewBox="0 0 132 121" fill="none" xmlns="http://www.w3.org/2000/svg">
              <g clipPath="url(#clip0_owner)">
                <path d="M12.383 29.0203C12.383 29.0203 12.5716 28.8946 12.6764 28.8527C13.4097 28.5803 14.2479 29.1879 14.4993 29.9422C14.7508 30.6966 14.5622 31.5137 14.3946 32.268C13.0954 37.9045 10.8744 43.8971 11.3773 49.7431C11.6706 53.2004 13.5774 57.6425 16.2803 59.8845C21.0996 63.8656 27.4484 57.7263 25.0807 52.488C24.0121 50.1202 22.273 47.8992 22.7549 45.1124C23.1949 42.5142 24.8712 40.9637 27.176 43.1218C29.6904 45.4896 33.2735 49.3659 31.7858 53.9547C30.4238 58.1663 26.0446 61.8331 23.2787 65.1228C12.8859 77.5062 12.5926 91.1467 11.1468 106.526C10.7068 111.283 10.4134 112.016 10.4134 112.016C10.4134 112.016 8.19238 111.43 7.29139 108.894C6.91423 107.826 6.47421 106.757 5.99229 105.709C5.80371 105.311 4.81891 101.665 4.1484 103.006C3.66648 103.991 3.35218 105.29 3.70838 106.38C4.31603 108.287 5.46846 111.723 6.3904 113.483C7.73141 115.997 10.0991 119.329 16.1965 119.622C28.4123 120.209 40.4814 120.146 52.6971 120.062C56.5735 120.041 62.7128 117.82 65.6463 114.992C68.5588 112.163 62.6709 108.831 60.1565 110.675C57.9355 112.31 58.0821 110.969 58.0821 110.969C57.9564 100.303 60.1146 89.5543 58.2288 78.931C56.9087 71.4507 51.398 66.4847 48.8836 59.5911C47.6893 56.3224 47.1026 53.0537 47.1026 51.2727C47.1026 41.697 60.8689 39.1407 65.9606 33.3157C65.9606 33.3157 71.0103 27.5326 72.058 24.1172C73.1056 20.7018 73.9857 14.3111 73.9857 11.65C73.9857 8.98896 72.7913 8.82133 74.4257 6.74696C76.06 4.67258 76.06 0.817183 73.9857 0.356211C69.1664 -0.6705 69.1664 0.251444 66.7149 3.91827C66.1282 4.81926 55.4211 5.40595 52.4667 4.96593C45.5521 3.93922 37.9879 3.62492 31.1781 5.40595C23.3416 7.48032 18.1452 14.3949 12.5297 19.8008C9.36577 22.86 5.30083 25.7725 2.78644 29.607C1.08922 32.1214 -0.126067 35.6834 -0.000347145 38.6588C0.146326 42.0532 3.66648 46.2858 7.50092 43.96C8.61145 43.2895 9.15623 41.9485 9.47053 40.6703C10.3296 37.0454 9.95246 33.0643 11.7544 29.8165C11.9221 29.5232 12.1316 29.2089 12.404 28.9993L12.383 29.0203Z" fill="#1872D9"/>
                <path d="M74.9714 114.007C75.118 114.007 75.2647 113.965 75.4114 113.881C75.4323 112.016 74.9295 110.193 74.5104 108.391C72.6036 100.22 72.2684 91.5449 74.1751 83.3312C75.0971 79.3082 76.5638 75.2432 78.722 71.7021C81.1107 67.8048 86.0137 63.2789 85.5737 58.3549C85.1337 53.4309 80.8173 51.0841 77.1296 49.0097C75.3695 48.0249 73.6513 46.621 73.1484 44.6724C72.3732 41.718 74.5732 38.9102 75.6628 36.0396C77.0248 32.4566 76.6895 28.5593 77.5067 24.8715C77.7582 23.7191 78.4496 20.4085 79.8325 20.0313C81.425 19.6123 82.9546 21.9381 84.0441 22.7343C88.9053 26.1707 94.7932 23.5724 99.361 20.9742C101.917 19.5075 103.489 20.5552 103.929 23.2791C104.411 26.2335 104.222 29.2508 104.495 32.2261C104.767 35.2015 105.689 38.1769 105.731 41.2361C105.773 45.0705 104.369 48.6535 100.974 50.665C98.1038 52.3622 92.0273 52.8442 92.1111 57.412C92.2369 63.2579 100.576 66.9876 104.117 70.6545C109.481 76.2071 113.819 82.8074 116.48 90.0781C117.548 93.0116 118.366 96.0708 118.24 99.1928C118.114 102.587 116.92 105.856 115.474 108.936C114.175 111.723 112.562 114.51 109.984 116.207C107.177 118.051 103.635 118.323 100.283 118.491C90.9797 118.973 81.5297 119.119 72.5198 116.752C71.0531 116.354 69.4816 115.809 68.6644 114.531C67.8472 113.252 68.4968 111.073 70.0264 111.01C71.996 110.927 73.2113 114.174 74.9504 114.007H74.9714ZM78.3867 108.999C78.3867 108.999 78.5125 109.188 78.5963 109.25C79.183 109.69 79.8954 109.188 79.8954 108.433C79.8954 106.799 79.183 100.785 80.1468 99.0881C81.1107 97.3908 83.4784 95.5889 84.1908 94.9393C84.9032 94.2898 87.1871 93.1583 87.1243 91.0839C87.0614 89.0095 86.9357 85.8037 85.0918 84.6931C83.2479 83.5826 83.3946 84.1693 81.8859 84.9236C80.3773 85.678 78.8268 87.2285 78.6801 88.9257C78.5334 90.6229 78.1563 91.0001 78.0934 93.0745C78.0305 95.1488 77.4439 98.7947 77.5067 100.722C77.5905 103.027 77.7162 105.353 78.0305 107.637C78.0934 108.014 78.1353 108.622 78.3448 109.02L78.3867 108.999Z" fill="#DE3D37"/>
                <path d="M113.776 111.765C118.888 111.681 123.896 110.508 125.845 105.248C128.171 98.9833 124.923 92.4668 122.492 86.7466C119.915 80.6701 112.602 65.9819 119.978 60.9112C122.932 58.8787 128.757 59.4445 129.114 63.9704C129.156 64.6409 129.218 67.8258 129.218 67.8258" stroke="#DE3D37" strokeWidth="4.19066" strokeMiterlimit="10" strokeLinecap="round"/>
              </g>
              <defs>
                <clipPath id="clip0_owner">
                  <rect width="131.314" height="120.167" fill="white"/>
                </clipPath>
              </defs>
            </svg>

            <p className="owner-text">
              От 2014 е собственик и управител на Мадара Вет.
            </p>
          </div>

        </div>
      </div>
    </section>
  );
}
